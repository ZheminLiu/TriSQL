drop table if exists ttt;		create table ttt(			node1 int,			node2 int,			label varchar(10)		);
insert into ttt					select *					from(select node1, node2, label						from(select graph.node1, graph.node2							from(select node								from label				where label = 'b'					)as ta							inner join graph					on ta.node = graph.node1					)as tb						inner join label					on tb.node2 = label.node order by node					)as tc				where tc.label in('a','e','c');
drop table if exists q1;
create table q1(b int,a int,e int,c int);
insert into q1 select ja.node1,ja.node2,jb.node2,jc.node2 from(select node1, node2					from ttt					where label = 'a')as ja inner join (select node1, node2					from ttt					where label = 'e')as jb on ja.node1 = jb.node1 inner join (select node1, node2					from ttt					where label = 'c')as jc on ja.node1 = jc.node1; 
delete from ttt;
insert into ttt					select *					from(select node1, node2, label						from(select graph.node1, graph.node2							from(select node								from label				where label = 'e'					)as ta							inner join graph					on ta.node = graph.node1					)as tb						inner join label					on tb.node2 = label.node order by node					)as tc				where tc.label in('a','d');
drop table if exists q2;
create table q2(e int,a int,d int);
insert into q2 select ja.node1,ja.node2,jb.node2 from(select node1, node2					from ttt					where label = 'a')as ja inner join (select node1, node2					from ttt					where label = 'd')as jb on ja.node1 = jb.node1; 
delete from ttt;
insert into ttt					select *					from(select node1, node2, label						from(select graph.node1, graph.node2							from(select node								from label				where label = 'c'					)as ta							inner join graph					on ta.node = graph.node1					)as tb						inner join label					on tb.node2 = label.node order by node					)as tc				where tc.label in('d');
drop table if exists q3;
create table q3(c int,d int);
insert into q3 select node1, node2 from ttt;
delete from ttt;
drop table if exists new;create table new(b int,a int,e int,c int,d int);
insert into new select q1.b,q1.a,q1.e,q1.c,q2.d from q1 inner join q2 on q1.e=q2.e and q1.a=q2.a;
drop table q2;
drop table q1;
alter table new rename to q1;
drop table if exists new;create table new(b int,a int,e int,c int,d int);
insert into new select q1.b,q1.a,q1.e,q1.c,q1.d from q1 inner join q3 on q1.c=q3.c and q1.d=q3.d;
drop table q3;
drop table q1;
alter table new rename to q1;
drop table ttt;
